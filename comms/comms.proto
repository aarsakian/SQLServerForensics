syntax = "proto3";



option go_package = "mssqlparser.comms";

message FileDetails {
    string Mdffile = 1;
    string Ldffile = 2;
}

message MTF {
    string MtfFile = 1;
}

message Col {
    string Name = 1;
    string Type = 2;
}

message Table {
    string Name = 1;
    string Type = 2;
    uint32 NofRows = 3;
    repeated Col Cols =4 ;
}

message TableResponse {
    oneof MessageType {
        Table Table = 1;
        Message Message =2; 
    }
}

message Rows {
    repeated Row row = 1;
}

message Database {
    string Name = 1;
    string ExportPath = 2;
}


message RowResponse {
    oneof MessageType {
        Row Row =1;
        Message Message=2;
    }
}
message Row {
    repeated string Vals = 1;
}

message Page {
    string Type = 1;
    uint32 ID = 2;
}

message Tables {
    repeated Table Tables = 1;
}

message Message {
    string Content = 1;
}

message Config {
    string ExporPath = 1;
}

service FileProcessorService {
    rpc SetConfig(Config) returns (Message){}
    rpc Process(FileDetails) returns (stream TableResponse){}
    rpc ProcessBak(MTF) returns (stream TableResponse){}
    rpc ExportTable(Table) returns (Message){}
    rpc ExportDatabase(Database) returns (stream Message){}
    rpc GetTableContents(Table) returns (stream Row) {}
    rpc GetTableAllocationInfo(Table) returns (stream Page) {}
    rpc MessageStream(stream Message) returns(stream Message) {}
   
}



